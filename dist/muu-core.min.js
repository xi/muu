(function(r,p,l){(function(m){"function"===typeof define&&define.amd?define("muu",["lodash"],m):r.muu=m(r._)})(function(m){var n={};n["muu-js-helpers"]={instance:m};var t=function(e,h){for(var f=[],a=0;a<e.length;a++)f.push(h(e[a]));return f};m=function(e,h,f){n[e]={deps:h,factory:f}};var s=function(e){if(!n[e])return l;n[e].instance||(n[e].instance=n[e].factory.apply(l,t(n[e].deps,s)));return n[e].instance};m("muu-directive",["muu-dom-helpers","muu-js-helpers","muu-update-dom"],function(e,h,f){return function(a,
c,d){var g=this;a.innerHTML="";var q=function(b){var k=b.currentTarget,c="data-on"+b.type;k.hasAttribute(c)&&(k=k.getAttribute(c),b=e.createEvent("muu-"+k,l,l,b),a.dispatchEvent(b))};this.update=function(b){f(a,d.renderer(c,b));h.forEach(["keydown","keyup","click","change","search"],function(b){h.forEach(g.querySelectorAll("[data-on"+b+"]"),function(a){a.addEventListener(b,q,!1)})});var k=e.createEvent("muu-parent-update");b=g.querySelectorAll("muu.muu-initialised");h.forEach(b,function(b){b.dispatchEvent(k)});
d.linkAll(g)};this.querySelectorAll=function(b){var c=a.querySelectorAll(b),d=a.querySelectorAll(".muu-isolate"),d=h.union(h.map(d,function(a){return a.querySelectorAll(b)}));return h.difference(c,d)};this.querySelector=function(b){b=g.querySelectorAll(b);if(0<b.length)return b[0]};this.on=function(b,c){return e.on(a,"muu-"+b,function(b){return c(b.detail)})};this.getModel=function(b,a){if(b===l){var c={};h.forEach(g.querySelectorAll("[name]"),function(b){c[b.name]=g.getModel(b.name)});return c}var d=
g.querySelector("[name="+b+"]");return d===l?a:"number"===d.getAttribute("type")?parseFloat(d.value):"checkbox"===d.getAttribute("type")?d.checked:"radio"===d.getAttribute("type")?(d=g.querySelectorAll("[name="+b+"]"),e.getRadio(d)||a):d.value};this.setModel=function(b,a){if(g.getModel(b)!==a){var d=g.querySelector("[name="+b+"]");"checkbox"===d.getAttribute("type")?d.checked=a:"radio"===d.getAttribute("type")?(d=g.querySelectorAll("[name="+b+"]"),e.setRadio(d,a)):d.value=a}}}});m("muu-dom-helpers",
["muu-js-helpers"],function(e){var h={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},f={DELAY:1E3,escapeHtml:function(a){return String(a).replace(/[&<>"'\/]/g,function(a){return h[a]})},createEvent:function(a,c,d,e){if("function"===typeof CustomEvent)return new CustomEvent(a,{detail:e,bubbles:c,cancelable:d});var q=p.createEvent("CustomEvent");q.initCustomEvent(a,c,d,e);return q},on:function(a,c,d){a.addEventListener(c,d,!1);return function(){a.removeEventListener(c,d,!1)}},
ready:function(a){a=e.once(a);if("complete"===p.readyState)return a(),function(){};var c=f.on(p,"DOMContentLoaded",a),d=f.on(r,"load",a);return function(){c();d()}},isDescendant:function(a,c){return!!a&&(a===c||f.isDescendant(a.parentNode,c))},destroy:function(a,c){var d;if(r.MutationObserver){var g=new MutationObserver(function(){f.isDescendant(a,p)||(c(),d())});g.observe(p,{childList:!0,subtree:!0});d=e.once(function(){g.disconnect();g=l})}else{var q=setInterval(function(){f.isDescendant(a,p)||
(c(),d())},f.DELAY);d=function(){clearInterval(q)}}return d},getRadio:function(a){for(var c=0;c<a.length;c++)if(a[c].checked)return a[c].value},setRadio:function(a,c){e.forEach(a,function(a){a.checked=a.value===c?!0:!1})}};return f});m("muu",["muu-registry","muu-dom-helpers","muu-location"],function(e,h,f){var a={};a.Registry=e;a.$=h;a.$location=f;return a});m("muu-registry",["muu-template","muu-directive","muu-js-helpers","muu-dom-helpers"],function(e,h,f,a){return function(c){var d=this,g={};this.config=
c||{};this.renderer=d.config.renderer||e;this.registerDirective=function(a,b,c){g[a]={template:b,link:c};return d};this.registerModule=function(a){a(d);return d};this.link=function(c,b){b===l&&(b=c.getAttribute("type"));if(!g.hasOwnProperty(b))throw Error("Unknown directive type: "+b);var e=g[b].link,f=new h(c,g[b].template,d),e=e(f,c);c.classList.add("muu-isolate");c.classList.add("muu-initialised");d.config.debug&&(c.directive=f);e!==l&&a.destroy(c,e);return f};this.linkAll=function(a){a=f.filter(a.querySelectorAll("muu"),
function(a){return!a.classList.contains("muu-initialised")});return f.map(a,function(a){return d.link(a)})}}});m("muu-update-dom",["muu-js-helpers"],function(e){var h=function(a,c){var d=e.filter(a.classList,function(a){return 0===a.lastIndexOf("muu-",0)}),g=e.map(a.attributes,function(a){return a.name}),f=e.map(c.attributes,function(a){return a.name});e.forEach(g,function(b){c.hasAttribute(b)||"__IE8__"===b.substr(0,7)||a.removeAttribute(b)});e.forEach(f,function(b){a.getAttribute(b)!==c.getAttribute(b)&&
a.setAttribute(b,c.getAttribute(b))});e.forEach(d,function(b){a.classList.add(b)})},f=function(a,c){for(var d=a.childNodes.length,e=c.childNodes.length,m=0,b=e;b<d;b++)a.removeChild(a.childNodes[e]);for(b=d;b<e;b++)a.appendChild(c.childNodes[d]);for(b=0;b<d&&b<e;b++){var k=a.childNodes[b],l=c.childNodes[b-m];k.nodeType===l.nodeType&&k.nodeName===l.nodeName&&k.type===l.type?(1===k.nodeType?h(k,l):3===k.nodeType&&(k.nodeValue=l.nodeValue),3===k.nodeType||k.classList.contains("muu-isolate")||f(k,l)):
(k.parentNode.replaceChild(l,k),m+=1)}};return function(a,c){var d=p.createElement("div");d.innerHTML=c;f(a,d)}});return s("muu")})})(window,document,void 0);
